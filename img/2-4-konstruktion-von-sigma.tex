%%
%% Abbildung 2-4
%% Kontruktion von Sigma in Lemma 2.5
%%
\begin{tikzpicture}

    \coordinate (ctrl1) at (0,1);
    \coordinate (ctrl2) at (1,0);
    \coordinate (ctrl3) at (1,1);
    \coordinate (ctrl4) at (0.1,-1);

% surrounding environment on M

    \coordinate (0) at (-3,1.75);
    \coordinate (1) at (-4.7,0.25);
    \coordinate (2) at (-2.5,-1.5);
    \coordinate (3) at (0,0);
    

    \draw (0) ..controls($(0) - 0.25*(ctrl2)$) and ($(1) + 1.25*(ctrl1)$).. 
	(1) ..controls($(1) - (ctrl1)$) and ($(2) - (ctrl2)$).. 
	(2) ..controls($(2) + (ctrl2)$) and ($(3) - 1*(ctrl1)$).. 
	(3) ..controls($(3) + (ctrl1)$) and ($(0) + (ctrl2)$).. (0);

    \node at (-0.5,1.5) {$\phi(U)$};
    
% interior neighbourhood

    \coordinate (p) at (-2.5,0);

    \coordinate (V1) at ($(p) + (0,0.7)$);
    \coordinate (V2) at ($(p) + (-1,0)$);
    \coordinate (V3) at ($(p) + (0,-1)$);
    \coordinate (V4) at ($(p) + (1.3,0)$);
	
    \draw (V1) ..controls($(V1) - 0.5*(ctrl2)$) and ($(V2) + 0.3*(ctrl1)$).. 
	(V2) ..controls($(V2) - 0.5*(ctrl1)$) and ($(V3) - 0.5*(ctrl2)$).. 
	(V3) ..controls($(V3) + 0.4*(ctrl2)$) and ($(V4) - 0.4*(ctrl1)$).. 
	(V4) ..controls($(V4) + 0.5*(ctrl1)$) and ($(V1) + 0.5*(ctrl2)$).. (V1);

    % point p
    \filldraw[fill=white] (p) circle(0.05)node[anchor=north west]{$\phi(p)$};
   
% coordinates

	\coordinate (C1) at (-4.7,-3.3);
	\coordinate (C2) at (0,-3.3);

	\coordinate (D1) at (-3.5,-3.3);
	\coordinate (D2) at (-1.2,-3.3);

	\coordinate (E1) at (-3.5,-2.2);
	\coordinate (E2) at (-1.2,-2.2);


	\draw (-6.05,-2.2) to (-5.95,-2.2) node[left] {$1$};

	\draw[->] (-6.5,-3.3) to (1.4,-3.3);
	\draw[->] (-6,-3.5) to (-6, -1.8);

	\draw[very thick]  (-6.3,-3.3) to (C1);
	\draw[very thick]  (C2) to (1,-3.3);
	\draw[very thick]  (E1) to (E2);
   
    \draw[dashed] (1) to (C1);
    \draw[dashed] (3) to (C2);
    \draw[dashed] (V2) to (D1);
    \draw[dashed] (V4) to (D2);

% connections

	\coordinate (F1) at (-4,-2.5);
	\coordinate (F2) at (-0.4,-2.5);
	\draw[densely dotted] (C1) ..controls($(C1) + 0.2*(ctrl2)$) and ($(F1) - 2*(ctrl4)$)..
	(F1) ..controls($(F1) + (ctrl4)$) and ($(E1) - 0.2*(ctrl2)$).. (E1);

	\draw[densely dotted] (E2) ..controls($(E2) + 0.4*(ctrl2)$) and ($(F2) - 2*(ctrl4)$)..
	(F2) ..controls($(F2) + 0.1*(ctrl4)$) and ($(C2) - 0.4*(ctrl2)$).. (C2);

    \filldraw[fill=white] (E1) circle(0.05);
    \filldraw[fill=white] (E2) circle(0.05);
    \filldraw[fill=white] (C1) circle(0.05);
    \filldraw[fill=white] (C2) circle(0.05);
\end{tikzpicture}